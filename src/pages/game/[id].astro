---
import jogos from '../../data/jogos.json';

export function getStaticPaths() {
  return jogos.map((jogo) => ({
    params: { id: jogo.id.toString() },
    props: { jogo },
  }));
}

const { jogo } = Astro.props;
---

<html lang="pt">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{jogo.titulo} | Gamer Portal</title>
  </head>
  <body>
    
    <nav>
      <a href="/" class="back-btn">‚¨Ö Voltar</a>
      <h1>{jogo.titulo}</h1>
    </nav>

    <main class="main-container">
      
      <div class="game-wrapper" id="gameArea">
        <iframe 
          src={jogo.url} 
          title={jogo.titulo}
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen"
          sandbox="allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-scripts allow-same-origin"
          allowfullscreen
        ></iframe>
      </div>

      <div class="controls-bar">
        <div class="info">
          <span class="category-tag">{jogo.categoria}</span>
          <span class="dica">Dica: Usa o bot√£o ao lado para jogar em grande! üëâ</span>
        </div>
        
        <button id="fullscreenBtn" class="fs-btn">
          ‚õ∂ Ecr√£ Cheio
        </button>
      </div>

    </main>

    <script is:inline>
      // O is:inline remove os erros vermelhos do editor
      const btn = document.getElementById('fullscreenBtn');
      const gameArea = document.getElementById('gameArea');

      if (btn && gameArea) {
        btn.addEventListener('click', () => {
          if (!document.fullscreenElement) {
            gameArea.requestFullscreen().catch(err => {
              console.warn(`Erro ao entrar em ecr√£ cheio: ${err.message}`);
            });
          } else {
            document.exitFullscreen();
          }
        });
      }
    </script>

  </body>
</html>

<style>
  /* Mantive o teu estilo que j√° estava excelente */
  :global(body), :global(html) {
    margin: 0; padding: 0; width: 100%; height: 100%;
    background-color: #050505; font-family: system-ui, sans-serif; color: white;
    overflow: hidden; /* Evita scroll duplo na p√°gina do jogo */
  }

  nav {
    height: 60px; background: #111; border-bottom: 1px solid #222;
    display: flex; align-items: center; padding: 0 20px; gap: 20px;
  }

  .back-btn {
    color: #aaa; text-decoration: none; font-weight: bold; font-size: 0.9rem;
    padding: 8px 16px; background: #222; border-radius: 20px; transition: 0.3s;
  }
  
  .back-btn:hover { background: #ff0055; color: white; }

  h1 { font-size: 1.1rem; margin: 0; color: white; }

  .main-container {
    display: flex; flex-direction: column; align-items: center;
    justify-content: center; padding: 20px; height: calc(100vh - 60px);
    box-sizing: border-box;
  }

  .game-wrapper {
    width: 100%; max-width: 1000px; aspect-ratio: 16/9;
    background: black; border-radius: 12px; overflow: hidden;
    box-shadow: 0 0 40px rgba(255, 0, 85, 0.1); border: 1px solid #333;
    position: relative;
  }

  iframe { width: 100%; height: 100%; border: none; display: block; }

  .controls-bar {
    width: 100%; max-width: 1000px; margin-top: 15px;
    display: flex; justify-content: space-between; align-items: center;
    background: #111; padding: 10px 20px; border-radius: 10px;
    border: 1px solid #222; box-sizing: border-box;
  }

  .info { display: flex; align-items: center; gap: 15px; font-size: 0.9rem; color: #888; }
  .category-tag {
    color: #ff0055; border: 1px solid #ff0055; padding: 2px 8px;
    border-radius: 4px; font-size: 0.75rem; text-transform: uppercase; font-weight: bold;
  }

  .fs-btn {
    background: #fff; color: #000; border: none; padding: 8px 16px;
    border-radius: 6px; cursor: pointer; font-weight: bold;
    display: flex; align-items: center; gap: 8px; transition: 0.2s;
  }

  .fs-btn:hover {
    background: #ff0055; color: white; box-shadow: 0 0 15px rgba(255, 0, 85, 0.5);
  }

  @media (max-width: 600px) {
    .main-container { padding: 10px; justify-content: start; }
    .game-wrapper { width: 100%; aspect-ratio: 16/9; }
    .dica { display: none; }
  }
</style>